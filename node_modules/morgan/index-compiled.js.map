{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/*!\n * morgan\n * Copyright(c) 2010 Sencha Inc.\n * Copyright(c) 2011 TJ Holowaychuk\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = morgan\nmodule.exports.compile = compile\nmodule.exports.format = format\nmodule.exports.token = token\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar auth = require('basic-auth')\nvar debug = require('debug')('morgan')\nvar deprecate = require('depd')('morgan')\nvar onFinished = require('on-finished')\nvar onHeaders = require('on-headers')\n\n/**\n * Array of CLF month names.\n * @private\n */\n\nvar CLF_MONTH = [\n  'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',\n  'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'\n]\n\n/**\n * Default log buffer duration.\n * @private\n */\n\nvar DEFAULT_BUFFER_DURATION = 1000\n\n/**\n * Create a logger middleware.\n *\n * @public\n * @param {String|Function} format\n * @param {Object} [options]\n * @return {Function} middleware\n */\n\nfunction morgan (format, options) {\n  var fmt = format\n  var opts = options || {}\n\n  if (format && typeof format === 'object') {\n    opts = format\n    fmt = opts.format || 'default'\n\n    // smart deprecation message\n    deprecate('morgan(options): use morgan(' + (typeof fmt === 'string' ? JSON.stringify(fmt) : 'format') + ', options) instead')\n  }\n\n  if (fmt === undefined) {\n    deprecate('undefined format: specify a format')\n  }\n\n  // output on request instead of response\n  var immediate = opts.immediate\n\n  // check if log entry should be skipped\n  var skip = opts.skip || false\n\n  // format function\n  var formatLine = typeof fmt !== 'function'\n    ? getFormatFunction(fmt)\n    : fmt\n\n  // stream\n  var buffer = opts.buffer\n  var stream = opts.stream || process.stdout\n\n  // buffering support\n  if (buffer) {\n    deprecate('buffer option')\n\n    // flush interval\n    var interval = typeof buffer !== 'number'\n      ? DEFAULT_BUFFER_DURATION\n      : buffer\n\n    // swap the stream\n    stream = createBufferStream(stream, interval)\n  }\n\n  return function logger (req, res, next) {\n    // request data\n    req._startAt = undefined\n    req._startTime = undefined\n    req._remoteAddress = getip(req)\n\n    // response data\n    res._startAt = undefined\n    res._startTime = undefined\n\n    // record request start\n    recordStartTime.call(req)\n\n    function logRequest () {\n      if (skip !== false && skip(req, res)) {\n        debug('skip request')\n        return\n      }\n\n      var line = formatLine(morgan, req, res)\n\n      if (line == null) {\n        debug('skip line')\n        return\n      }\n\n      debug('log request')\n      stream.write(line + '\\n')\n    };\n\n    if (immediate) {\n      // immediate log\n      logRequest()\n    } else {\n      // record response start\n      onHeaders(res, recordStartTime)\n\n      // log when response finished\n      onFinished(res, logRequest)\n    }\n\n    next()\n  }\n}\n\n/**\n * Apache combined log format.\n */\n\nmorgan.format('combined', ':remote-addr - :remote-user [:date[clf]] \":method :url HTTP/:http-version\" :status :res[content-length] \":referrer\" \":user-agent\"')\n\n/**\n * Apache common log format.\n */\n\nmorgan.format('common', ':remote-addr - :remote-user [:date[clf]] \":method :url HTTP/:http-version\" :status :res[content-length]')\n\n/**\n * Default format.\n */\n\nmorgan.format('default', ':remote-addr - :remote-user [:date] \":method :url HTTP/:http-version\" :status :res[content-length] \":referrer\" \":user-agent\"')\ndeprecate.property(morgan, 'default', 'default format: use combined format')\n\n/**\n * Short format.\n */\n\nmorgan.format('short', ':remote-addr :remote-user :method :url HTTP/:http-version :status :res[content-length] - :response-time ms')\n\n/**\n * Tiny format.\n */\n\nmorgan.format('tiny', ':method :url :status :res[content-length] - :response-time ms')\n\n/**\n * dev (colored)\n */\n\nmorgan.format('dev', function developmentFormatLine (tokens, req, res) {\n  // get the status code if response written\n  var status = res._header\n    ? res.statusCode\n    : undefined\n\n  // get status color\n  var color = status >= 500 ? 31 // red\n    : status >= 400 ? 33 // yellow\n    : status >= 300 ? 36 // cyan\n    : status >= 200 ? 32 // green\n    : 0 // no color\n\n  // get colored function\n  var fn = developmentFormatLine[color]\n\n  if (!fn) {\n    // compile\n    fn = developmentFormatLine[color] = compile('\\x1b[0m:method :url \\x1b[' +\n      color + 'm:status \\x1b[0m:response-time ms - :res[content-length]\\x1b[0m')\n  }\n\n  return fn(tokens, req, res)\n})\n\n/**\n * request url\n */\n\nmorgan.token('url', function getUrlToken (req) {\n  return req.originalUrl || req.url\n})\n\n/**\n * request method\n */\n\nmorgan.token('method', function getMethodToken (req) {\n  return req.method\n})\n\n/**\n * response time in milliseconds\n */\n\nmorgan.token('response-time', function getResponseTimeToken (req, res, digits) {\n  if (!req._startAt || !res._startAt) {\n    // missing request and/or response start time\n    return\n  }\n\n  // calculate diff\n  var ms = (res._startAt[0] - req._startAt[0]) * 1e3 +\n    (res._startAt[1] - req._startAt[1]) * 1e-6\n\n  // return truncated value\n  return ms.toFixed(digits === undefined ? 3 : digits)\n})\n\n/**\n * current date\n */\n\nmorgan.token('date', function getDateToken (req, res, format) {\n  var date = new Date()\n\n  switch (format || 'web') {\n    case 'clf':\n      return clfdate(date)\n    case 'iso':\n      return date.toISOString()\n    case 'web':\n      return date.toUTCString()\n  }\n})\n\n/**\n * response status code\n */\n\nmorgan.token('status', function getStatusToken (req, res) {\n  return res._header\n    ? String(res.statusCode)\n    : undefined\n})\n\n/**\n * normalized referrer\n */\n\nmorgan.token('referrer', function getReferrerToken (req) {\n  return req.headers['referer'] || req.headers['referrer']\n})\n\n/**\n * remote address\n */\n\nmorgan.token('remote-addr', getip)\n\n/**\n * remote user\n */\n\nmorgan.token('remote-user', function getRemoteUserToken (req) {\n  // parse basic credentials\n  var credentials = auth(req)\n\n  // return username\n  return credentials\n    ? credentials.name\n    : undefined\n})\n\n/**\n * HTTP version\n */\n\nmorgan.token('http-version', function getHttpVersionToken (req) {\n  return req.httpVersionMajor + '.' + req.httpVersionMinor\n})\n\n/**\n * UA string\n */\n\nmorgan.token('user-agent', function getUserAgentToken (req) {\n  return req.headers['user-agent']\n})\n\n/**\n * request header\n */\n\nmorgan.token('req', function getRequestToken (req, res, field) {\n  // get header\n  var header = req.headers[field.toLowerCase()]\n\n  return Array.isArray(header)\n    ? header.join(', ')\n    : header\n})\n\n/**\n * response header\n */\n\nmorgan.token('res', function getResponseHeader (req, res, field) {\n  if (!res._header) {\n    return undefined\n  }\n\n  // get header\n  var header = res.getHeader(field)\n\n  return Array.isArray(header)\n    ? header.join(', ')\n    : header\n})\n\n/**\n * Format a Date in the common log format.\n *\n * @private\n * @param {Date} dateTime\n * @return {string}\n */\n\nfunction clfdate (dateTime) {\n  var date = dateTime.getUTCDate()\n  var hour = dateTime.getUTCHours()\n  var mins = dateTime.getUTCMinutes()\n  var secs = dateTime.getUTCSeconds()\n  var year = dateTime.getUTCFullYear()\n\n  var month = CLF_MONTH[dateTime.getUTCMonth()]\n\n  return pad2(date) + '/' + month + '/' + year +\n    ':' + pad2(hour) + ':' + pad2(mins) + ':' + pad2(secs) +\n    ' +0000'\n}\n\n/**\n * Compile a format string into a function.\n *\n * @param {string} format\n * @return {function}\n * @public\n */\n\nfunction compile (format) {\n  if (typeof format !== 'string') {\n    throw new TypeError('argument format must be a string')\n  }\n\n  var fmt = format.replace(/\"/g, '\\\\\"')\n  var js = '  \"use strict\"\\n  return \"' + fmt.replace(/:([-\\w]{2,})(?:\\[([^\\]]+)\\])?/g, function (_, name, arg) {\n    var tokenArguments = 'req, res'\n    var tokenFunction = 'tokens[' + String(JSON.stringify(name)) + ']'\n\n    if (arg !== undefined) {\n      tokenArguments += ', ' + String(JSON.stringify(arg))\n    }\n\n    return '\" +\\n    (' + tokenFunction + '(' + tokenArguments + ') || \"-\") + \"'\n  }) + '\"'\n\n  // eslint-disable-next-line no-new-func\n  return new Function('tokens, req, res', js)\n}\n\n/**\n * Create a basic buffering stream.\n *\n * @param {object} stream\n * @param {number} interval\n * @public\n */\n\nfunction createBufferStream (stream, interval) {\n  var buf = []\n  var timer = null\n\n  // flush function\n  function flush () {\n    timer = null\n    stream.write(buf.join(''))\n    buf.length = 0\n  }\n\n  // write function\n  function write (str) {\n    if (timer === null) {\n      timer = setTimeout(flush, interval)\n    }\n\n    buf.push(str)\n  }\n\n  // return a minimal \"stream\"\n  return { write: write }\n}\n\n/**\n * Define a format with the given name.\n *\n * @param {string} name\n * @param {string|function} fmt\n * @public\n */\n\nfunction format (name, fmt) {\n  morgan[name] = fmt\n  return this\n}\n\n/**\n * Lookup and compile a named format function.\n *\n * @param {string} name\n * @return {function}\n * @public\n */\n\nfunction getFormatFunction (name) {\n  // lookup format\n  var fmt = morgan[name] || name || morgan.default\n\n  // return compiled format\n  return typeof fmt !== 'function'\n    ? compile(fmt)\n    : fmt\n}\n\n/**\n * Get request IP address.\n *\n * @private\n * @param {IncomingMessage} req\n * @return {string}\n */\n\nfunction getip (req) {\n  return req.ip ||\n    req._remoteAddress ||\n    (req.connection && req.connection.remoteAddress) ||\n    undefined\n}\n\n/**\n * Pad number to two digits.\n *\n * @private\n * @param {number} num\n * @return {string}\n */\n\nfunction pad2 (num) {\n  var str = String(num)\n\n  return (str.length === 1 ? '0' : '') + str\n}\n\n/**\n * Record the start time.\n * @private\n */\n\nfunction recordStartTime () {\n  this._startAt = process.hrtime()\n  this._startTime = new Date()\n}\n\n/**\n * Define a token function with the given name,\n * and callback fn(req, res).\n *\n * @param {string} name\n * @param {function} fn\n * @public\n */\n\nfunction token (name, fn) {\n  morgan[name] = fn\n  return this\n}\n"]}