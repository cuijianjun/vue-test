{"version":3,"sources":["cors.js"],"names":[],"mappings":"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","file":"cors-compiled.js","sourcesContent":["(function () {\n  /*global describe, it*/\n\n  'use strict';\n\n  var should = require('should'),\n    cors = require('../lib');\n\n  var fakeRequest = function (headers) {\n      return {\n        headers: headers || {\n          'origin': 'request.com',\n          'access-control-request-headers': 'requestedHeader1,requestedHeader2'\n        },\n        pause: function () {\n          // do nothing\n          return;\n        },\n        resume: function () {\n          // do nothing\n          return;\n        }\n      };\n    },\n    fakeResponse = function () {\n      var headers = {};\n      return {\n        allHeaders: function () {\n          return headers;\n        },\n        getHeader: function (key) {\n          return headers[key];\n        },\n        setHeader: function (key, value) {\n          headers[key] = value;\n          return;\n        },\n        get: function (key) {\n          return headers[key];\n        }\n      };\n    };\n\n  describe('cors', function () {\n    it('does not alter `options` configuration object', function () {\n      var options = Object.freeze({\n        origin: 'custom-origin'\n      });\n      (function () {\n        cors(options);\n      }).should.not.throw();\n    });\n\n    it('passes control to next middleware', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      res = fakeResponse();\n      next = function () {\n        done();\n      };\n\n      // act\n      cors()(req, res, next);\n    });\n\n    it('shortcircuits preflight requests', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      req.method = 'OPTIONS';\n      res = fakeResponse();\n      res.end = function () {\n        // assert\n        res.statusCode.should.equal(204);\n        done();\n      };\n      next = function () {\n        // assert\n        done('should not be called');\n      };\n\n      // act\n      cors()(req, res, next);\n    });\n\n    it('can configure preflight success response status code', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      req.method = 'OPTIONS';\n      res = fakeResponse();\n      res.end = function () {\n        // assert\n        res.statusCode.should.equal(200);\n        done();\n      };\n      next = function () {\n        // assert\n        done('should not be called');\n      };\n\n      // act\n      cors({optionsSuccessStatus: 200})(req, res, next);\n    });\n\n    it('doesn\\'t shortcircuit preflight requests with preflightContinue option', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      req.method = 'OPTIONS';\n      res = fakeResponse();\n      res.end = function () {\n        // assert\n        done('should not be called');\n      };\n      next = function () {\n        // assert\n        done();\n      };\n\n      // act\n      cors({preflightContinue: true})(req, res, next);\n    });\n\n    it('normalizes method names', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      req.method = 'options';\n      res = fakeResponse();\n      res.end = function () {\n        // assert\n        res.statusCode.should.equal(204);\n        done();\n      };\n      next = function () {\n        // assert\n        done('should not be called');\n      };\n\n      // act\n      cors()(req, res, next);\n    });\n\n    it('includes Content-Length response header', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      req.method = 'options';\n      res = fakeResponse();\n      res.end = function () {\n        // assert\n        res.getHeader('Content-Length').should.equal('0');\n        done();\n      };\n      next = function () {\n        // assert\n        done('should not be called');\n      };\n\n      // act\n      cors()(req, res, next);\n    });\n\n    it('no options enables default CORS to all origins', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      res = fakeResponse();\n      next = function () {\n        // assert\n        res.getHeader('Access-Control-Allow-Origin').should.equal('*');\n        should.not.exist(res.getHeader('Access-Control-Allow-Methods'));\n        done();\n      };\n\n      // act\n      cors()(req, res, next);\n    });\n\n    it('OPTION call with no options enables default CORS to all origins and methods', function (done) {\n      // arrange\n      var req, res, next;\n      req = fakeRequest();\n      req.method = 'OPTIONS';\n      res = fakeResponse();\n      res.end = function () {\n        // assert\n        res.statusCode.should.equal(204);\n        done();\n      };\n      next = function () {\n        // assert\n        res.getHeader('Access-Control-Allow-Origin').should.equal('*');\n        res.getHeader('Access-Control-Allow-Methods').should.equal('GET,PUT,PATCH,POST,DELETE');\n        done();\n      };\n\n      // act\n      cors()(req, res, next);\n    });\n\n    describe('passing static options', function () {\n      it('overrides defaults', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          origin: 'example.com',\n          methods: ['FOO', 'bar'],\n          headers: ['FIZZ', 'buzz'],\n          credentials: true,\n          maxAge: 123\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.statusCode.should.equal(204);\n          done();\n        };\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Origin').should.equal('example.com');\n          res.getHeader('Access-Control-Allow-Methods').should.equal('FOO,bar');\n          res.getHeader('Access-Control-Allow-Headers').should.equal('FIZZ,buzz');\n          res.getHeader('Access-Control-Allow-Credentials').should.equal('true');\n          res.getHeader('Access-Control-Max-Age').should.equal('123');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('matches request origin against regexp', function(done) {\n        var req = fakeRequest();\n        var res = fakeResponse();\n        var options = { origin: /^(.+\\.)?request.com$/ };\n        cors(options)(req, res, function(err) {\n          should.not.exist(err);\n          res.getHeader('Access-Control-Allow-Origin').should.equal(req.headers.origin);\n          should.exist(res.getHeader('Vary'));\n          res.getHeader('Vary').should.equal('Origin');\n          return done();\n        });\n      });\n\n      it('matches request origin against array of origin checks', function(done) {\n        var req = fakeRequest();\n        var res = fakeResponse();\n        var options = { origin: [ /foo\\.com$/, 'request.com' ] };\n        cors(options)(req, res, function(err) {\n          should.not.exist(err);\n          res.getHeader('Access-Control-Allow-Origin').should.equal(req.headers.origin);\n          should.exist(res.getHeader('Vary'));\n          res.getHeader('Vary').should.equal('Origin');\n          return done();\n        });\n      });\n\n      it('doesn\\'t match request origin against array of invalid origin checks', function(done) {\n        var req = fakeRequest();\n        var res = fakeResponse();\n        var options = { origin: [ /foo\\.com$/, 'bar.com' ] };\n        cors(options)(req, res, function(err) {\n          should.not.exist(err);\n          should.not.exist(res.getHeader('Access-Control-Allow-Origin'));\n          should.exist(res.getHeader('Vary'));\n          res.getHeader('Vary').should.equal('Origin');\n          return done();\n        });\n      });\n\n      it('origin of false disables cors', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          origin: false,\n          methods: ['FOO', 'bar'],\n          headers: ['FIZZ', 'buzz'],\n          credentials: true,\n          maxAge: 123\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          should.not.exist(res.getHeader('Access-Control-Allow-Origin'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Methods'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Headers'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Credentials'));\n          should.not.exist(res.getHeader('Access-Control-Max-Age'));\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('can override origin', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          origin: 'example.com'\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Origin').should.equal('example.com');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('includes Vary header for specific origins', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          origin: 'example.com'\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          should.exist(res.getHeader('Vary'));\n          res.getHeader('Vary').should.equal('Origin');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('appends to an existing Vary header', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          origin: 'example.com'\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        res.setHeader('Vary', 'Foo');\n        next = function () {\n          // assert\n          res.getHeader('Vary').should.equal('Foo, Origin');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('origin defaults to *', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Origin').should.equal('*');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('specifying true for origin reflects requesting origin', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          origin: true\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Origin').should.equal('request.com');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('should allow origin when callback returns true', function (done) {\n        var req, res, next, options;\n        options = {\n          origin: function (sentOrigin, cb) {\n            sentOrigin.should.equal('request.com');\n            cb(null, true);\n          }\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          res.getHeader('Access-Control-Allow-Origin').should.equal('request.com');\n          done();\n        };\n\n        cors(options)(req, res, next);\n      });\n\n      it('should not allow origin when callback returns false', function (done) {\n        var req, res, next, options;\n        options = {\n          origin: function (sentOrigin, cb) {\n            sentOrigin.should.equal('request.com');\n            cb(null, false);\n          }\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          should.not.exist(res.getHeader('Access-Control-Allow-Origin'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Methods'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Headers'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Credentials'));\n          should.not.exist(res.getHeader('Access-Control-Max-Age'));\n          done();\n        };\n\n        cors(options)(req, res, next);\n      });\n\n      it('should not override options.origin callback', function (done) {\n        var req, res, next, options;\n        options = {\n          origin: function (sentOrigin, cb) {\n            var isValid = sentOrigin === 'request.com';\n            cb(null, isValid);\n          }\n        };\n\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          res.getHeader('Access-Control-Allow-Origin').should.equal('request.com');\n        };\n\n        cors(options)(req, res, next);\n\n        req = fakeRequest({\n          'origin': 'invalid-request.com'\n        });\n        res = fakeResponse();\n\n        next = function () {\n          should.not.exist(res.getHeader('Access-Control-Allow-Origin'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Methods'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Headers'));\n          should.not.exist(res.getHeader('Access-Control-Allow-Credentials'));\n          should.not.exist(res.getHeader('Access-Control-Max-Age'));\n          done();\n        };\n\n        cors(options)(req, res, next);\n      });\n\n\n      it('can override methods', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          methods: ['method1', 'method2']\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.statusCode.should.equal(204);\n          done();\n        };\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Methods').should.equal('method1,method2');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('methods defaults to GET, PUT, PATCH, POST, DELETE', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.statusCode.should.equal(204);\n          done();\n        };\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Methods').should.equal('GET,PUT,PATCH,POST,DELETE');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('can specify allowed headers', function (done) {\n        // arrange\n        var req, res, options;\n        options = {\n          allowedHeaders: ['header1', 'header2']\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Headers').should.equal('header1,header2');\n          should.not.exist(res.getHeader('Vary'));\n          done();\n        };\n\n        // act\n        cors(options)(req, res, null);\n      });\n\n      it('specifying an empty list or string of allowed headers will result in no response header for allowed headers', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          allowedHeaders: []\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          should.not.exist(res.getHeader('Access-Control-Allow-Headers'));\n          should.not.exist(res.getHeader('Vary'));\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('if no allowed headers are specified, defaults to requested allowed headers', function (done) {\n        // arrange\n        var req, res, options;\n        options = {\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Headers').should.equal('requestedHeader1,requestedHeader2');\n          should.exist(res.getHeader('Vary'));\n          res.getHeader('Vary').should.equal('Access-Control-Request-Headers');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, null);\n      });\n\n      it('can specify exposed headers', function (done) {\n        // arrange\n        var req, res, options, next;\n        options = {\n          exposedHeaders: ['custom-header1', 'custom-header2']\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Expose-Headers').should.equal('custom-header1,custom-header2');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('specifying an empty list or string of exposed headers will result in no response header for exposed headers', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n          exposedHeaders: []\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          should.not.exist(res.getHeader('Access-Control-Expose-Headers'));\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('includes credentials if explicitly enabled', function (done) {\n        // arrange\n        var req, res, options;\n        options = {\n          credentials: true\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Credentials').should.equal('true');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, null);\n      });\n\n      it('does not includes credentials unless explicitly enabled', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          should.not.exist(res.getHeader('Access-Control-Allow-Credentials'));\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n\n      it('includes maxAge when specified', function (done) {\n        // arrange\n        var req, res, options;\n        options = {\n          maxAge: 456\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.getHeader('Access-Control-Max-Age').should.equal('456');\n          done();\n        };\n\n        // act\n        cors(options)(req, res, null);\n      });\n\n      it('does not includes maxAge unless specified', function (done) {\n        // arrange\n        var req, res, next, options;\n        options = {\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          should.not.exist(res.getHeader('Access-Control-Max-Age'));\n          done();\n        };\n\n        // act\n        cors(options)(req, res, next);\n      });\n    });\n\n    describe('passing a function to build options', function () {\n      it('handles options specified via callback', function (done) {\n        // arrange\n        var req, res, next, delegate;\n        delegate = function (req2, cb) {\n          cb(null, {\n            origin: 'delegate.com'\n          });\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Origin').should.equal('delegate.com');\n          done();\n        };\n\n        // act\n        cors(delegate)(req, res, next);\n      });\n\n      it('handles options specified via callback for preflight', function (done) {\n        // arrange\n        var req, res, delegate;\n        delegate = function (req2, cb) {\n          cb(null, {\n            origin: 'delegate.com',\n            maxAge: 1000\n          });\n        };\n        req = fakeRequest();\n        req.method = 'OPTIONS';\n        res = fakeResponse();\n        res.end = function () {\n          // assert\n          res.getHeader('Access-Control-Allow-Origin').should.equal('delegate.com');\n          res.getHeader('Access-Control-Max-Age').should.equal('1000');\n          done();\n        };\n\n        // act\n        cors(delegate)(req, res, null);\n      });\n\n      it('handles error specified via callback', function (done) {\n        // arrange\n        var req, res, next, delegate;\n        delegate = function (req2, cb) {\n          cb('some error');\n        };\n        req = fakeRequest();\n        res = fakeResponse();\n        next = function (err) {\n          // assert\n          err.should.equal('some error');\n          done();\n        };\n\n        // act\n        cors(delegate)(req, res, next);\n      });\n    });\n  });\n\n}());\n"]}