{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["import Vue from 'vue';\nimport merge from 'element-ui/src/utils/merge';\nimport PopupManager from 'element-ui/src/utils/popup/popup-manager';\nimport getScrollBarWidth from '../scrollbar-width';\n\nlet idSeed = 1;\nconst transitions = [];\n\nconst hookTransition = (transition) => {\n  if (transitions.indexOf(transition) !== -1) return;\n\n  const getVueInstance = (element) => {\n    let instance = element.__vue__;\n    if (!instance) {\n      const textNode = element.previousSibling;\n      if (textNode.__vue__) {\n        instance = textNode.__vue__;\n      }\n    }\n    return instance;\n  };\n\n  Vue.transition(transition, {\n    afterEnter(el) {\n      const instance = getVueInstance(el);\n\n      if (instance) {\n        instance.doAfterOpen && instance.doAfterOpen();\n      }\n    },\n    afterLeave(el) {\n      const instance = getVueInstance(el);\n\n      if (instance) {\n        instance.doAfterClose && instance.doAfterClose();\n      }\n    }\n  });\n};\n\nlet scrollBarWidth;\n\nconst getDOM = function(dom) {\n  if (dom.nodeType === 3) {\n    dom = dom.nextElementSibling || dom.nextSibling;\n    getDOM(dom);\n  }\n  return dom;\n};\n\nexport default {\n  model: {\n    prop: 'visible',\n    event: 'visible-change'\n  },\n  props: {\n    visible: {\n      type: Boolean,\n      default: false\n    },\n    transition: {\n      type: String,\n      default: ''\n    },\n    openDelay: {},\n    closeDelay: {},\n    zIndex: {},\n    modal: {\n      type: Boolean,\n      default: false\n    },\n    modalFade: {\n      type: Boolean,\n      default: true\n    },\n    modalClass: {},\n    modalAppendToBody: {\n      type: Boolean,\n      default: false\n    },\n    lockScroll: {\n      type: Boolean,\n      default: true\n    },\n    closeOnPressEscape: {\n      type: Boolean,\n      default: false\n    },\n    closeOnClickModal: {\n      type: Boolean,\n      default: false\n    }\n  },\n\n  created() {\n    if (this.transition) {\n      hookTransition(this.transition);\n    }\n  },\n\n  beforeMount() {\n    this._popupId = 'popup-' + idSeed++;\n    PopupManager.register(this._popupId, this);\n  },\n\n  beforeDestroy() {\n    PopupManager.deregister(this._popupId);\n    PopupManager.closeModal(this._popupId);\n    if (this.modal && this.bodyOverflow !== null && this.bodyOverflow !== 'hidden') {\n      document.body.style.overflow = this.bodyOverflow;\n      document.body.style.paddingRight = this.bodyPaddingRight;\n    }\n    this.bodyOverflow = null;\n    this.bodyPaddingRight = null;\n  },\n\n  data() {\n    return {\n      opened: false,\n      bodyOverflow: null,\n      bodyPaddingRight: null,\n      rendered: false\n    };\n  },\n\n  watch: {\n    visible(val) {\n      if (val) {\n        if (this._opening) return;\n        if (!this.rendered) {\n          this.rendered = true;\n          Vue.nextTick(() => {\n            this.open();\n          });\n        } else {\n          this.open();\n        }\n      } else {\n        this.close();\n      }\n    }\n  },\n\n  methods: {\n    open(options) {\n      if (!this.rendered) {\n        this.rendered = true;\n        this.$emit('visible-change', true);\n      }\n\n      const props = merge({}, this.$props || this, options);\n\n      if (this._closeTimer) {\n        clearTimeout(this._closeTimer);\n        this._closeTimer = null;\n      }\n      clearTimeout(this._openTimer);\n\n      const openDelay = Number(props.openDelay);\n      if (openDelay > 0) {\n        this._openTimer = setTimeout(() => {\n          this._openTimer = null;\n          this.doOpen(props);\n        }, openDelay);\n      } else {\n        this.doOpen(props);\n      }\n    },\n\n    doOpen(props) {\n      if (this.$isServer) return;\n      if (this.willOpen && !this.willOpen()) return;\n      if (this.opened) return;\n\n      this._opening = true;\n\n      this.$emit('visible-change', true);\n\n      const dom = getDOM(this.$el);\n\n      const modal = props.modal;\n\n      const zIndex = props.zIndex;\n      if (zIndex) {\n        PopupManager.zIndex = zIndex;\n      }\n\n      if (modal) {\n        if (this._closing) {\n          PopupManager.closeModal(this._popupId);\n          this._closing = false;\n        }\n        PopupManager.openModal(this._popupId, PopupManager.nextZIndex(), this.modalAppendToBody ? undefined : dom, props.modalClass, props.modalFade);\n        if (props.lockScroll) {\n          if (!this.bodyOverflow) {\n            this.bodyPaddingRight = document.body.style.paddingRight;\n            this.bodyOverflow = document.body.style.overflow;\n          }\n          scrollBarWidth = getScrollBarWidth();\n          let bodyHasOverflow = document.documentElement.clientHeight < document.body.scrollHeight;\n          if (scrollBarWidth > 0 && bodyHasOverflow) {\n            document.body.style.paddingRight = scrollBarWidth + 'px';\n          }\n          document.body.style.overflow = 'hidden';\n        }\n      }\n\n      if (getComputedStyle(dom).position === 'static') {\n        dom.style.position = 'absolute';\n      }\n\n      dom.style.zIndex = PopupManager.nextZIndex();\n      this.opened = true;\n\n      this.onOpen && this.onOpen();\n\n      if (!this.transition) {\n        this.doAfterOpen();\n      }\n    },\n\n    doAfterOpen() {\n      this._opening = false;\n    },\n\n    close() {\n      if (this.willClose && !this.willClose()) return;\n\n      if (this._openTimer !== null) {\n        clearTimeout(this._openTimer);\n        this._openTimer = null;\n      }\n      clearTimeout(this._closeTimer);\n\n      const closeDelay = Number(this.closeDelay);\n\n      if (closeDelay > 0) {\n        this._closeTimer = setTimeout(() => {\n          this._closeTimer = null;\n          this.doClose();\n        }, closeDelay);\n      } else {\n        this.doClose();\n      }\n    },\n\n    doClose() {\n      this.$emit('visible-change', false);\n      this._closing = true;\n\n      this.onClose && this.onClose();\n\n      if (this.lockScroll) {\n        setTimeout(() => {\n          if (this.modal && this.bodyOverflow !== 'hidden') {\n            document.body.style.overflow = this.bodyOverflow;\n            document.body.style.paddingRight = this.bodyPaddingRight;\n          }\n          this.bodyOverflow = null;\n          this.bodyPaddingRight = null;\n        }, 200);\n      }\n\n      this.opened = false;\n\n      if (!this.transition) {\n        this.doAfterClose();\n      }\n    },\n\n    doAfterClose() {\n      PopupManager.closeModal(this._popupId);\n      this._closing = false;\n    }\n  }\n};\n\nexport {\n  PopupManager\n};\n"]}