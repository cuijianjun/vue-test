{"version":3,"sources":["table-store.js"],"names":[],"mappings":"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","file":"table-store-compiled.js","sourcesContent":["import Vue from 'vue';\nimport debounce from 'throttle-debounce/debounce';\nimport { orderBy, getColumnById, getRowIdentity } from './util';\n\nconst sortData = (data, states) => {\n  const sortingColumn = states.sortingColumn;\n  if (!sortingColumn || typeof sortingColumn.sortable === 'string') {\n    return data;\n  }\n  return orderBy(data, states.sortProp, states.sortOrder, sortingColumn.sortMethod);\n};\n\nconst getKeysMap = function(array, rowKey) {\n  const arrayMap = {};\n  (array || []).forEach((row, index) => {\n    arrayMap[getRowIdentity(row, rowKey)] = { row, index };\n  });\n  return arrayMap;\n};\n\nconst toggleRowSelection = function(states, row, selected) {\n  let changed = false;\n  const selection = states.selection;\n  const index = selection.indexOf(row);\n  if (typeof selected === 'undefined') {\n    if (index === -1) {\n      selection.push(row);\n      changed = true;\n    } else {\n      selection.splice(index, 1);\n      changed = true;\n    }\n  } else {\n    if (selected && index === -1) {\n      selection.push(row);\n      changed = true;\n    } else if (!selected && index > -1) {\n      selection.splice(index, 1);\n      changed = true;\n    }\n  }\n\n  return changed;\n};\n\nconst TableStore = function(table, initialState = {}) {\n  if (!table) {\n    throw new Error('Table is required.');\n  }\n  this.table = table;\n\n  this.states = {\n    rowKey: null,\n    _columns: [],\n    originColumns: [],\n    columns: [],\n    fixedColumns: [],\n    rightFixedColumns: [],\n    isComplex: false,\n    _data: null,\n    filteredData: null,\n    data: null,\n    sortingColumn: null,\n    sortProp: null,\n    sortOrder: null,\n    isAllSelected: false,\n    selection: [],\n    reserveSelection: false,\n    selectable: null,\n    currentRow: null,\n    hoverRow: null,\n    filters: {},\n    expandRows: [],\n    defaultExpandAll: false\n  };\n\n  for (let prop in initialState) {\n    if (initialState.hasOwnProperty(prop) && this.states.hasOwnProperty(prop)) {\n      this.states[prop] = initialState[prop];\n    }\n  }\n};\n\nTableStore.prototype.mutations = {\n  setData(states, data) {\n    const dataInstanceChanged = states._data !== data;\n    states._data = data;\n    states.data = sortData((data || []), states);\n\n    // states.data.forEach((item) => {\n    //   if (!item.$extra) {\n    //     Object.defineProperty(item, '$extra', {\n    //       value: {},\n    //       enumerable: false\n    //     });\n    //   }\n    // });\n\n    this.updateCurrentRow();\n\n    if (!states.reserveSelection) {\n      if (dataInstanceChanged) {\n        this.clearSelection();\n      } else {\n        this.cleanSelection();\n      }\n      this.updateAllSelected();\n    } else {\n      const rowKey = states.rowKey;\n      if (rowKey) {\n        const selection = states.selection;\n        const selectedMap = getKeysMap(selection, rowKey);\n\n        states.data.forEach((row) => {\n          const rowId = getRowIdentity(row, rowKey);\n          const rowInfo = selectedMap[rowId];\n          if (rowInfo) {\n            selection[rowInfo.index] = row;\n          }\n        });\n\n        this.updateAllSelected();\n      } else {\n        console.warn('WARN: rowKey is required when reserve-selection is enabled.');\n      }\n    }\n\n    const defaultExpandAll = states.defaultExpandAll;\n    if (defaultExpandAll) {\n      this.states.expandRows = (states.data || []).slice(0);\n    }\n\n    Vue.nextTick(() => this.table.updateScrollY());\n  },\n\n  changeSortCondition(states) {\n    states.data = sortData((states.filteredData || states._data || []), states);\n\n    this.table.$emit('sort-change', {\n      column: this.states.sortingColumn,\n      prop: this.states.sortProp,\n      order: this.states.sortOrder\n    });\n\n    Vue.nextTick(() => this.table.updateScrollY());\n  },\n\n  filterChange(states, options) {\n    let { column, values, silent } = options;\n    if (values && !Array.isArray(values)) {\n      values = [values];\n    }\n\n    const prop = column.property;\n    const filters = {};\n\n    if (prop) {\n      states.filters[column.id] = values;\n      filters[column.columnKey || column.id] = values;\n    }\n\n    let data = states._data;\n\n    Object.keys(states.filters).forEach((columnId) => {\n      const values = states.filters[columnId];\n      if (!values || values.length === 0) return;\n      const column = getColumnById(this.states, columnId);\n      if (column && column.filterMethod) {\n        data = data.filter((row) => {\n          return values.some(value => column.filterMethod.call(null, value, row));\n        });\n      }\n    });\n\n    states.filteredData = data;\n    states.data = sortData(data, states);\n\n    if (!silent) {\n      this.table.$emit('filter-change', filters);\n    }\n\n    Vue.nextTick(() => this.table.updateScrollY());\n  },\n\n  insertColumn(states, column, index, parent) {\n    let array = states._columns;\n    if (parent) {\n      array = parent.children;\n      if (!array) array = parent.children = [];\n    }\n\n    if (typeof index !== 'undefined') {\n      array.splice(index, 0, column);\n    } else {\n      array.push(column);\n    }\n\n    if (column.type === 'selection') {\n      states.selectable = column.selectable;\n      states.reserveSelection = column.reserveSelection;\n    }\n\n    this.updateColumns();  // hack for dynamics insert column\n    this.scheduleLayout();\n  },\n\n  removeColumn(states, column) {\n    let _columns = states._columns;\n    if (_columns) {\n      _columns.splice(_columns.indexOf(column), 1);\n    }\n\n    this.updateColumns();  // hack for dynamics remove column\n    this.scheduleLayout();\n  },\n\n  setHoverRow(states, row) {\n    states.hoverRow = row;\n  },\n\n  setCurrentRow(states, row) {\n    const oldCurrentRow = states.currentRow;\n    states.currentRow = row;\n\n    if (oldCurrentRow !== row) {\n      this.table.$emit('current-change', row, oldCurrentRow);\n    }\n  },\n\n  rowSelectedChanged(states, row) {\n    const changed = toggleRowSelection(states, row);\n    const selection = states.selection;\n\n    if (changed) {\n      const table = this.table;\n      table.$emit('selection-change', selection);\n      table.$emit('select', selection, row);\n    }\n\n    this.updateAllSelected();\n  },\n\n  toggleRowExpanded: function(states, row, expanded) {\n    const expandRows = states.expandRows;\n    if (typeof expanded !== 'undefined') {\n      const index = expandRows.indexOf(row);\n      if (expanded) {\n        if (index === -1) expandRows.push(row);\n      } else {\n        if (index !== -1) expandRows.splice(index, 1);\n      }\n    } else {\n      const index = expandRows.indexOf(row);\n      if (index === -1) {\n        expandRows.push(row);\n      } else {\n        expandRows.splice(index, 1);\n      }\n    }\n    this.table.$emit('expand', row, expandRows.indexOf(row) !== -1);\n  },\n\n  toggleAllSelection: debounce(10, function(states) {\n    const data = states.data || [];\n    const value = !states.isAllSelected;\n    const selection = this.states.selection;\n    let selectionChanged = false;\n\n    data.forEach((item, index) => {\n      if (states.selectable) {\n        if (states.selectable.call(null, item, index) && toggleRowSelection(states, item, value)) {\n          selectionChanged = true;\n        }\n      } else {\n        if (toggleRowSelection(states, item, value)) {\n          selectionChanged = true;\n        }\n      }\n    });\n\n    const table = this.table;\n    if (selectionChanged) {\n      table.$emit('selection-change', selection);\n    }\n    table.$emit('select-all', selection);\n    states.isAllSelected = value;\n  })\n};\n\nconst doFlattenColumns = (columns) => {\n  const result = [];\n  columns.forEach((column) => {\n    if (column.children) {\n      result.push.apply(result, doFlattenColumns(column.children));\n    } else {\n      result.push(column);\n    }\n  });\n  return result;\n};\n\nTableStore.prototype.updateColumns = function() {\n  const states = this.states;\n  const _columns = states._columns || [];\n  states.fixedColumns = _columns.filter((column) => column.fixed === true || column.fixed === 'left');\n  states.rightFixedColumns = _columns.filter((column) => column.fixed === 'right');\n\n  if (states.fixedColumns.length > 0 && _columns[0] && _columns[0].type === 'selection' && !_columns[0].fixed) {\n    _columns[0].fixed = true;\n    states.fixedColumns.unshift(_columns[0]);\n  }\n  states.originColumns = [].concat(states.fixedColumns).concat(_columns.filter((column) => !column.fixed)).concat(states.rightFixedColumns);\n  states.columns = doFlattenColumns(states.originColumns);\n  states.isComplex = states.fixedColumns.length > 0 || states.rightFixedColumns.length > 0;\n};\n\nTableStore.prototype.isSelected = function(row) {\n  return (this.states.selection || []).indexOf(row) > -1;\n};\n\nTableStore.prototype.clearSelection = function() {\n  const states = this.states;\n  states.isAllSelected = false;\n  const oldSelection = states.selection;\n  states.selection = [];\n  if (oldSelection.length > 0) {\n    this.table.$emit('selection-change', states.selection);\n  }\n};\n\nTableStore.prototype.setExpandRowKeys = function(rowKeys) {\n  const expandRows = [];\n  const data = this.states.data;\n  const rowKey = this.states.rowKey;\n  if (!rowKey) throw new Error('[Table] prop row-key should not be empty.');\n  const keysMap = getKeysMap(data, rowKey);\n  rowKeys.forEach((key) => {\n    const info = keysMap[key];\n    if (info) {\n      expandRows.push(info.row);\n    }\n  });\n\n  this.states.expandRows = expandRows;\n};\n\nTableStore.prototype.toggleRowSelection = function(row, selected) {\n  const changed = toggleRowSelection(this.states, row, selected);\n  if (changed) {\n    this.table.$emit('selection-change', this.states.selection);\n  }\n};\n\nTableStore.prototype.cleanSelection = function() {\n  const selection = this.states.selection || [];\n  const data = this.states.data;\n  const rowKey = this.states.rowKey;\n  let deleted;\n  if (rowKey) {\n    deleted = [];\n    const selectedMap = getKeysMap(selection, rowKey);\n    const dataMap = getKeysMap(data, rowKey);\n    for (let key in selectedMap) {\n      if (selectedMap.hasOwnProperty(key) && !dataMap[key]) {\n        deleted.push(selectedMap[key].row);\n      }\n    }\n  } else {\n    deleted = selection.filter((item) => {\n      return data.indexOf(item) === -1;\n    });\n  }\n\n  deleted.forEach((deletedItem) => {\n    selection.splice(selection.indexOf(deletedItem), 1);\n  });\n\n  if (deleted.length) {\n    this.table.$emit('selection-change', selection);\n  }\n};\n\nTableStore.prototype.updateAllSelected = function() {\n  const states = this.states;\n  const { selection, rowKey, selectable, data } = states;\n  if (!data || data.length === 0) {\n    states.isAllSelected = false;\n    return;\n  }\n\n  let selectedMap;\n  if (rowKey) {\n    selectedMap = getKeysMap(states.selection, rowKey);\n  }\n\n  const isSelected = function(row) {\n    if (selectedMap) {\n      return !!selectedMap[getRowIdentity(row, rowKey)];\n    } else {\n      return selection.indexOf(row) !== -1;\n    }\n  };\n\n  let isAllSelected = true;\n  let selectedCount = 0;\n  for (let i = 0, j = data.length; i < j; i++) {\n    const item = data[i];\n    if (selectable) {\n      const isRowSelectable = selectable.call(null, item, i);\n      if (isRowSelectable) {\n        if (!isSelected(item)) {\n          isAllSelected = false;\n          break;\n        } else {\n          selectedCount++;\n        }\n      }\n    } else {\n      if (!isSelected(item)) {\n        isAllSelected = false;\n        break;\n      } else {\n        selectedCount++;\n      }\n    }\n  }\n\n  if (selectedCount === 0) isAllSelected = false;\n\n  states.isAllSelected = isAllSelected;\n};\n\nTableStore.prototype.scheduleLayout = function() {\n  this.table.debouncedLayout();\n};\n\nTableStore.prototype.setCurrentRowKey = function(key) {\n  const states = this.states;\n  const rowKey = states.rowKey;\n  if (!rowKey) throw new Error('[Table] row-key should not be empty.');\n  const data = states.data || [];\n  const keysMap = getKeysMap(data, rowKey);\n  const info = keysMap[key];\n  if (info) {\n    states.currentRow = info.row;\n  }\n};\n\nTableStore.prototype.updateCurrentRow = function() {\n  const states = this.states;\n  const table = this.table;\n  const data = states.data || [];\n  const oldCurrentRow = states.currentRow;\n\n  if (data.indexOf(oldCurrentRow) === -1) {\n    states.currentRow = null;\n\n    if (states.currentRow !== oldCurrentRow) {\n      table.$emit('current-change', null, oldCurrentRow);\n    }\n  }\n};\n\nTableStore.prototype.commit = function(name, ...args) {\n  const mutations = this.mutations;\n  if (mutations[name]) {\n    mutations[name].apply(this, [this.states].concat(args));\n  } else {\n    throw new Error(`Action not found: ${name}`);\n  }\n};\n\nexport default TableStore;\n"]}