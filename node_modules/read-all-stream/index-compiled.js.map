{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,WAAW,QAAQ,iBAAR,EAA2B,QAA1C;AACA,IAAI,WAAW,QAAQ,MAAR,EAAgB,QAA/B;AACA,IAAI,UAAU,QAAQ,gBAAR,CAAd;;AAEA,SAAS,YAAT,GAAwB;AACvB,UAAS,IAAT,CAAc,IAAd,EAAoB,EAAE,YAAY,IAAd,EAApB;AACA,MAAK,MAAL,GAAc,EAAd;AACA,MAAK,MAAL,GAAc,CAAd;AACA;;AAED,SAAS,YAAT,EAAuB,QAAvB;AACA,aAAa,SAAb,CAAuB,MAAvB,GAAgC,UAAS,KAAT,EAAgB,GAAhB,EAAqB,IAArB,EAA2B;AAC1D,KAAI,CAAC,OAAO,QAAP,CAAgB,KAAhB,CAAL,EAA6B;AAC5B,UAAQ,IAAI,MAAJ,CAAW,KAAX,CAAR;AACA;;AAED,MAAK,MAAL,CAAY,IAAZ,CAAiB,KAAjB;AACA,MAAK,MAAL,IAAe,MAAM,MAArB;AACA;AACA,CARD;;AAUA,OAAO,OAAP,GAAiB,SAAS,IAAT,CAAc,MAAd,EAAsB,OAAtB,EAA+B,EAA/B,EAAmC;AACnD,KAAI,CAAC,MAAL,EAAa;AACZ,QAAM,IAAI,KAAJ,CAAU,6BAAV,CAAN;AACA;;AAED,KAAI,OAAO,OAAP,KAAmB,UAAvB,EAAmC;AAClC,OAAK,OAAL;AACA,YAAU,EAAV;AACA;;AAED,KAAI,OAAO,OAAP,KAAmB,QAAnB,IAA+B,YAAY,SAA3C,IAAwD,YAAY,IAAxE,EAA8E;AAC7E,YAAU,EAAE,UAAU,OAAZ,EAAV;AACA;;AAED,KAAI,QAAQ,QAAR,KAAqB,SAAzB,EAAoC;AAAE,UAAQ,QAAR,GAAmB,MAAnB;AAA4B;;AAElE,KAAI,OAAJ;;AAEA,KAAI,CAAC,EAAL,EAAS;AACR,MAAI,OAAJ,EAAa,MAAb;AACA,YAAU,IAAI,OAAJ,CAAY,UAAS,IAAT,EAAe,IAAf,EAAqB;AAC1C,aAAU,IAAV;AACA,YAAS,IAAT;AACA,GAHS,CAAV;;AAKA,OAAK,YAAU,GAAV,EAAe,IAAf,EAAqB;AACzB,OAAI,GAAJ,EAAS;AAAE,WAAO,OAAO,GAAP,CAAP;AAAqB;AAChC,WAAQ,IAAR;AACA,GAHD;AAIA;;AAED,KAAI,OAAO,IAAI,YAAJ,EAAX;;AAEA,MAAK,EAAL,CAAQ,QAAR,EAAkB,YAAY;AAC7B,MAAI,OAAO,OAAO,MAAP,CAAc,KAAK,MAAnB,EAA2B,KAAK,MAAhC,CAAX;;AAEA,MAAI,QAAQ,QAAZ,EAAsB;AACrB,UAAO,KAAK,QAAL,CAAc,QAAQ,QAAtB,CAAP;AACA;;AAED,KAAG,IAAH,EAAS,IAAT;AACA,EARD;;AAUA,QAAO,IAAP,CAAY,OAAZ,EAAqB,EAArB;;AAEA,QAAO,IAAP,CAAY,IAAZ;;AAEA,QAAO,OAAP;AACA,CAhDD","file":"index-compiled.js","sourcesContent":["'use strict';\n\nvar Writable = require('readable-stream').Writable;\nvar inherits = require('util').inherits;\nvar Promise = require('pinkie-promise');\n\nfunction BufferStream() {\n\tWritable.call(this, { objectMode: true });\n\tthis.buffer = [];\n\tthis.length = 0;\n}\n\ninherits(BufferStream, Writable);\nBufferStream.prototype._write = function(chunk, enc, next) {\n\tif (!Buffer.isBuffer(chunk)) {\n\t\tchunk = new Buffer(chunk);\n\t}\n\n\tthis.buffer.push(chunk);\n\tthis.length += chunk.length;\n\tnext();\n};\n\nmodule.exports = function read(stream, options, cb) {\n\tif (!stream) {\n\t\tthrow new Error('stream argument is required');\n\t}\n\n\tif (typeof options === 'function') {\n\t\tcb = options;\n\t\toptions = {};\n\t}\n\n\tif (typeof options === 'string' || options === undefined || options === null) {\n\t\toptions = { encoding: options };\n\t}\n\n\tif (options.encoding === undefined) { options.encoding = 'utf8'; }\n\n\tvar promise;\n\n\tif (!cb) {\n\t\tvar resolve, reject;\n\t\tpromise = new Promise(function(_res, _rej) {\n\t\t\tresolve = _res;\n\t\t\treject = _rej;\n\t\t});\n\n\t\tcb = function (err, data) {\n\t\t\tif (err) { return reject(err); }\n\t\t\tresolve(data);\n\t\t};\n\t}\n\n\tvar sink = new BufferStream();\n\n\tsink.on('finish', function () {\n\t\tvar data = Buffer.concat(this.buffer, this.length);\n\n\t\tif (options.encoding) {\n\t\t\tdata = data.toString(options.encoding);\n\t\t}\n\n\t\tcb(null, data);\n\t});\n\n\tstream.once('error', cb);\n\n\tstream.pipe(sink);\n\n\treturn promise;\n}\n"]}