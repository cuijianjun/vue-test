{"version":3,"sources":["defaults.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,KAAK,QAAQ,IAAR,CAAT;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,UAAU,QAAQ,SAAR,CAAd;AACA,IAAI,SAAS,QAAQ,QAAR,CAAb;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,cAAc,QAAQ,aAAR,CAAlB;AACA,IAAI,eAAe,QAAQ,cAAR,CAAnB;AACA,IAAI,eAAe,QAAQ,eAAR,CAAnB;AACA,IAAI,aAAa,QAAQ,eAAR,CAAjB;;AAEA,OAAO,OAAP,GAAiB,UAAU,IAAV,EAAgB;AAC/B,MAAI,UAAU,KAAK,IAAL,CAAU,QAAQ,GAAR,EAAV,EAAyB,QAAzB,CAAd;AACA,MAAI,aAAa,KAAK,IAAL,CAAU,SAAV,EAAqB,QAArB,CAAjB;AACA,MAAI,YAAY,GAAG,UAAH,CAAc,OAAd,IAAyB,OAAzB,GAAmC,UAAnD;;AAEA,SAAO,aAAa,EAAE,QAAQ,IAAV,EAAgB,QAAQ,SAAxB,EAAb,EAAkD,IAAlD,CAAP;;AAEA,MAAI,MAAM,EAAV;;AAEA;AACA,MAAI,CAAC,KAAK,MAAV,EAAkB;AAChB,QAAI,IAAJ,CAAS,aAAT;AACD;;AAED;AACA,MAAI,KAAK,MAAT,EAAiB;AACf,QAAI,IAAJ,CAAS,OAAO,KAAP,EAAc;AACrB,YAAM,SAAS,IAAT,CAAc,GAAd,EAAmB;AACvB,eAAO,QAAQ,GAAR,CAAY,QAAZ,KAAyB,MAAzB,IAAmC,IAAI,IAAJ,KAAa,cAAvD;AACD;AAHoB,KAAd,CAAT;AAKD;;AAED;AACA,MAAI,CAAC,KAAK,MAAV,EAAkB;AAChB,QAAI,IAAJ,CAAS,KAAK,EAAE,QAAQ,IAAV,EAAgB,aAAa,IAA7B,EAAL,CAAT;AACD;;AAED,MAAI,QAAQ,GAAR,CAAY,QAAZ,KAAyB,aAA7B,EAA4C;AAC1C;AACA,QAAI,IAAJ,CAAS,cAAT;AACD;;AAED;AACA,MAAI,IAAJ,CAAS,QAAQ,MAAR,CAAe,KAAK,MAApB,CAAT;;AAEA;AACA;AACA,MAAI,IAAJ,CAAS,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACjC,QAAI,MAAJ,CAAW,eAAX,EAA4B,UAA5B;AACA,QAAI,MAAJ,CAAW,QAAX,EAAqB,UAArB;AACA,QAAI,MAAJ,CAAW,SAAX,EAAsB,IAAtB;AACA;AACD,GALD;;AAOA;AACA,MAAI,KAAK,QAAT,EAAmB;AACjB,QAAI,IAAJ,CAAS,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACjC,UAAI,IAAI,MAAJ,KAAe,KAAnB,EAA0B;AACxB,eADwB,CAChB;AACT,OAFD,MAEO;AACL,YAAI,UAAJ,CAAe,GAAf,EADK,CACgB;AACtB;AACF,KAND;AAOD;;AAED;AACA,MAAI,KAAK,UAAT,EAAqB;AACnB,QAAI,IAAJ,CAAS,UAAT;AACD;;AAED,SAAO,GAAP;AACD,CA9DD","file":"defaults-compiled.js","sourcesContent":["'use strict';\n\nvar fs = require('fs');\nvar path = require('path');\nvar express = require('express');\nvar logger = require('morgan');\nvar cors = require('cors');\nvar compression = require('compression');\nvar errorhandler = require('errorhandler');\nvar objectAssign = require('object-assign');\nvar bodyParser = require('./body-parser');\n\nmodule.exports = function (opts) {\n  var userDir = path.join(process.cwd(), 'public');\n  var defaultDir = path.join(__dirname, 'public');\n  var staticDir = fs.existsSync(userDir) ? userDir : defaultDir;\n\n  opts = objectAssign({ logger: true, static: staticDir }, opts);\n\n  var arr = [];\n\n  // Compress all requests\n  if (!opts.noGzip) {\n    arr.push(compression());\n  }\n\n  // Logger\n  if (opts.logger) {\n    arr.push(logger('dev', {\n      skip: function skip(req) {\n        return process.env.NODE_ENV === 'test' || req.path === '/favicon.ico';\n      }\n    }));\n  }\n\n  // Enable CORS for all the requests, including static files\n  if (!opts.noCors) {\n    arr.push(cors({ origin: true, credentials: true }));\n  }\n\n  if (process.env.NODE_ENV === 'development') {\n    // only use in development\n    arr.push(errorhandler());\n  }\n\n  // Serve static files\n  arr.push(express.static(opts.static));\n\n  // No cache for IE\n  // https://support.microsoft.com/en-us/kb/234067\n  arr.push(function (req, res, next) {\n    res.header('Cache-Control', 'no-cache');\n    res.header('Pragma', 'no-cache');\n    res.header('Expires', '-1');\n    next();\n  });\n\n  // Read-only\n  if (opts.readOnly) {\n    arr.push(function (req, res, next) {\n      if (req.method === 'GET') {\n        next(); // Continue\n      } else {\n        res.sendStatus(403); // Forbidden\n      }\n    });\n  }\n\n  // Add middlewares\n  if (opts.bodyParser) {\n    arr.push(bodyParser);\n  }\n\n  return arr;\n};"]}