{"version":3,"sources":["index-compiled.js"],"names":[],"mappings":"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","file":"index-compiled-compiled.js","sourcesContent":["'use strict';\n\nimport _Object$keys from \"babel-runtime/core-js/object/keys\";\nimport _Symbol$iterator from \"babel-runtime/core-js/symbol/iterator\";\nimport _typeof2 from \"babel-runtime/helpers/typeof\";\nimport _Symbol from \"babel-runtime/core-js/symbol\";\nimport _Object$assign from \"babel-runtime/core-js/object/assign\";\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = _Object$assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }return target;\n};\n\nvar _typeof = typeof _Symbol === \"function\" && _typeof2(_Symbol$iterator) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof2(obj);\n} : function (obj) {\n  return obj && typeof _Symbol === \"function\" && obj.constructor === _Symbol && obj !== _Symbol.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof2(obj);\n};\n\nvar _util = require('./util');\n\nvar _validator = require('./validator/');\n\nvar _validator2 = _interopRequireDefault(_validator);\n\nvar _messages2 = require('./messages');\n\nvar _rule = require('./rule/');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : { \"default\": obj };\n}\n\n/**\n *  Encapsulates a validation schema.\n *\n *  @param descriptor An object declaring validation rules\n *  for this schema.\n */\nfunction Schema(descriptor) {\n  this.rules = null;\n  this._messages = _messages2.messages;\n  this.define(descriptor);\n}\n\nSchema.prototype = {\n  messages: function messages(_messages) {\n    if (_messages) {\n      this._messages = (0, _util.deepMerge)((0, _messages2.newMessages)(), _messages);\n    }\n    return this._messages;\n  },\n  define: function define(rules) {\n    if (!rules) {\n      throw new Error('Cannot configure a schema with no rules');\n    }\n    if ((typeof rules === 'undefined' ? 'undefined' : _typeof(rules)) !== 'object' || Array.isArray(rules)) {\n      throw new Error('Rules must be an object');\n    }\n    this.rules = {};\n    var z = void 0;\n    var item = void 0;\n    for (z in rules) {\n      if (rules.hasOwnProperty(z)) {\n        item = rules[z];\n        this.rules[z] = Array.isArray(item) ? item : [item];\n      }\n    }\n  },\n  validate: function validate(source_) {\n    var _this = this;\n\n    var o = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var oc = arguments[2];\n\n    var source = source_;\n    var options = o;\n    var callback = oc;\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n    if (!this.rules || _Object$keys(this.rules).length === 0) {\n      if (callback) {\n        callback();\n      }\n      return;\n    }\n    function complete(results) {\n      var i = void 0;\n      var field = void 0;\n      var errors = [];\n      var fields = {};\n\n      function add(e) {\n        if (Array.isArray(e)) {\n          errors = errors.concat.apply(errors, e);\n        } else {\n          errors.push(e);\n        }\n      }\n\n      for (i = 0; i < results.length; i++) {\n        add(results[i]);\n      }\n      if (!errors.length) {\n        errors = null;\n        fields = null;\n      } else {\n        for (i = 0; i < errors.length; i++) {\n          field = errors[i].field;\n          fields[field] = fields[field] || [];\n          fields[field].push(errors[i]);\n        }\n      }\n      callback(errors, fields);\n    }\n\n    if (options.messages) {\n      var messages = this.messages();\n      if (messages === _messages2.messages) {\n        messages = (0, _messages2.newMessages)();\n      }\n      (0, _util.deepMerge)(messages, options.messages);\n      options.messages = messages;\n    } else {\n      options.messages = this.messages();\n    }\n\n    options.error = _rule.error;\n    var arr = void 0;\n    var value = void 0;\n    var series = {};\n    var keys = options.keys || _Object$keys(this.rules);\n    keys.forEach(function (z) {\n      arr = _this.rules[z];\n      value = source[z];\n      arr.forEach(function (r) {\n        var rule = r;\n        if (typeof rule.transform === 'function') {\n          if (source === source_) {\n            source = _extends({}, source);\n          }\n          value = source[z] = rule.transform(value);\n        }\n        if (typeof rule === 'function') {\n          rule = {\n            validator: rule\n          };\n        } else {\n          rule = _extends({}, rule);\n        }\n        rule.validator = _this.getValidationMethod(rule);\n        rule.field = z;\n        rule.fullField = rule.fullField || z;\n        rule.type = _this.getType(rule);\n        if (!rule.validator) {\n          return;\n        }\n        series[z] = series[z] || [];\n        series[z].push({\n          rule: rule,\n          value: value,\n          source: source,\n          field: z\n        });\n      });\n    });\n    var errorFields = {};\n    (0, _util.asyncMap)(series, options, function (data, doIt) {\n      var rule = data.rule;\n      var deep = (rule.type === 'object' || rule.type === 'array') && (_typeof(rule.fields) === 'object' || _typeof(rule.defaultField) === 'object');\n      deep = deep && (rule.required || !rule.required && data.value);\n      rule.field = data.field;\n      function addFullfield(key, schema) {\n        return _extends({}, schema, {\n          fullField: rule.fullField + '.' + key\n        });\n      }\n\n      function cb() {\n        var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n        var errors = e;\n        if (!Array.isArray(errors)) {\n          errors = [errors];\n        }\n        if (errors.length) {\n          (0, _util.warning)('async-validator:', errors);\n        }\n        if (errors.length && rule.message) {\n          errors = [].concat(rule.message);\n        }\n\n        errors = errors.map((0, _util.complementError)(rule));\n\n        if ((options.first || options.fieldFirst) && errors.length) {\n          errorFields[rule.field] = 1;\n          return doIt(errors);\n        }\n        if (!deep) {\n          doIt(errors);\n        } else {\n          // if rule is required but the target object\n          // does not exist fail at the rule level and don't\n          // go deeper\n          if (rule.required && !data.value) {\n            if (rule.message) {\n              errors = [].concat(rule.message).map((0, _util.complementError)(rule));\n            } else {\n              errors = [options.error(rule, (0, _util.format)(options.messages.required, rule.field))];\n            }\n            return doIt(errors);\n          }\n\n          var fieldsSchema = {};\n          if (rule.defaultField) {\n            for (var k in data.value) {\n              if (data.value.hasOwnProperty(k)) {\n                fieldsSchema[k] = rule.defaultField;\n              }\n            }\n          }\n          fieldsSchema = _extends({}, fieldsSchema, data.rule.fields);\n          for (var f in fieldsSchema) {\n            if (fieldsSchema.hasOwnProperty(f)) {\n              var fieldSchema = Array.isArray(fieldsSchema[f]) ? fieldsSchema[f] : [fieldsSchema[f]];\n              fieldsSchema[f] = fieldSchema.map(addFullfield.bind(null, f));\n            }\n          }\n          var schema = new Schema(fieldsSchema);\n          schema.messages(options.messages);\n          if (data.rule.options) {\n            data.rule.options.messages = options.messages;\n            data.rule.options.error = options.error;\n          }\n          schema.validate(data.value, data.rule.options || options, function (errs) {\n            doIt(errs && errs.length ? errors.concat(errs) : errs);\n          });\n        }\n      }\n\n      rule.validator(rule, data.value, cb, data.source, options);\n    }, function (results) {\n      complete(results);\n    });\n  },\n  getType: function getType(rule) {\n    if (rule.type === undefined && rule.pattern instanceof RegExp) {\n      rule.type = 'pattern';\n    }\n    if (typeof rule.validator !== 'function' && rule.type && !_validator2[\"default\"].hasOwnProperty(rule.type)) {\n      throw new Error((0, _util.format)('Unknown rule type %s', rule.type));\n    }\n    return rule.type || 'string';\n  },\n  getValidationMethod: function getValidationMethod(rule) {\n    if (typeof rule.validator === 'function') {\n      return rule.validator;\n    }\n    var keys = _Object$keys(rule);\n    var messageIndex = keys.indexOf('message');\n    if (messageIndex !== -1) {\n      keys.splice(messageIndex, 1);\n    }\n    if (keys.length === 1 && keys[0] === 'required') {\n      return _validator2[\"default\"].required;\n    }\n    return _validator2[\"default\"][this.getType(rule)] || false;\n  }\n};\n\nSchema.register = function register(type, validator) {\n  if (typeof validator !== 'function') {\n    throw new Error('Cannot register a validator by type, validator is not a function');\n  }\n  _validator2[\"default\"][type] = validator;\n};\n\nSchema.messages = _messages2.messages;\n\nexports[\"default\"] = Schema;\nmodule.exports = exports['default'];\n\n//# sourceMappingURL=index-compiled.js.map"]}